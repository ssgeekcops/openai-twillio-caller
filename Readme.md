# OpenAI Realtime + Twilio Voice Agent

This project implements a **real-time, human-like AI voice agent** using **Twilio Voice Media Streams** and **OpenAI’s Realtime API**.

The agent can hold **natural, interruptible phone conversations**, respond with low latency, and behave like a real human on a business call.
It supports both **phone-based calling** and **browser-based calling (WebRTC)** for low-cost development and testing.

---

## What This Project Does

- Accepts incoming phone calls via Twilio
- Streams live call audio to OpenAI Realtime
- Streams AI-generated speech back to the caller
- Handles interruptions naturally (caller can speak anytime)
- Sounds calm, professional, and conversational (Indian business tone)
- Collects only three details during the call:
  - Name
  - Job title
  - City
- Avoids guessing, repetition, or robotic behavior
- Supports browser-based calling for development/testing
- Supports outbound calls via API (optional)

---

## Architecture Overview

Caller (Phone or Browser)  
↓  
Twilio Voice  
↓  
Media Stream (WebSocket)  
↓  
FastAPI Server (this repository)  
↓  
OpenAI Realtime API  
↓  
AI-generated Audio  
↓  
Twilio → Caller  

The server acts as a **live audio bridge** between Twilio and OpenAI.

---

## AI Model and Voice

- Model: `gpt-realtime-mini`
- Reason: Low latency, cost-efficient, supports live audio and interruption handling
- Voice: `verse` (OpenAI Realtime voice)

The AI voice is generated by **OpenAI**, not Twilio.  
Twilio only handles call transport and audio streaming.

---

## Project Structure

```
openai-twillio-caller/
├── main.py
├── call.html
├── requirements.txt
├── .env.example
├── README.md
└── .gitignore
```

---

## Environment Variables

Create a `.env` file locally. **Do not commit this file.**

```
OPENAI_API_KEY=sk-...
TWILIO_ACCOUNT_SID=AC...
TWILIO_AUTH_TOKEN=...
TWILIO_PHONE_NUMBER=+1XXXXXXXXXX

PORT=5050
TEMPERATURE=0.45
```

In production (Railway), these variables are set in the Railway dashboard.

---

## Running Locally

```bash
python -m venv env
source env/bin/activate
pip install -r requirements.txt
python main.py
```

Expose locally for Twilio testing:

```bash
ngrok http 5050
```

Update your Twilio webhook to:

```
https://<ngrok-url>/incoming-call
```

---

## Browser-Based Testing (Recommended)

Browser testing avoids phone charges and provides better audio quality.

Endpoint:

```
GET /browser
```

Browser access is protected using the header:

```
X-DEV: true
```

---

## Outbound Calling (Optional)

Endpoint:

```
POST /call
```

Payload example:

```json
{
  "to": "+91XXXXXXXXXX"
}
```

This endpoint should be protected in production.

---

## Deployment (Railway – Recommended)

Start command:

```bash
uvicorn main:app --host 0.0.0.0 --port $PORT
```

Twilio webhook:

```
https://your-app.up.railway.app/incoming-call
```

---

## Development Guidelines

- Prefer browser-based testing
- Use PSTN calls only for final validation
- Never commit secrets
- Keep responses short and natural

---

## Design Goals

- Human-like conversational flow
- Low latency
- Natural interruptions
- Calm, professional tone
- Minimal data collection
- Cost-efficient scaling

---

## Future Improvements

- Persistent memory
- CRM / webhook handoff
- Call analytics
- Admin dashboard
- Multi-agent routing

---

## License

MIT
